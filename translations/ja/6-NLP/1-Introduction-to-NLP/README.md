<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "89e923cf3e8bdff9662536e8bf9516e6",
  "translation_date": "2025-09-04T00:46:16+00:00",
  "source_file": "6-NLP/1-Introduction-to-NLP/README.md",
  "language_code": "ja"
}
-->
# 自然言語処理の紹介

このレッスンでは、*自然言語処理*（NLP）という*計算言語学*のサブフィールドの簡単な歴史と重要な概念について学びます。

## [講義前のクイズ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/31/)

## はじめに

一般的にNLPと呼ばれる自然言語処理は、機械学習が適用され、実際のソフトウェアで使用されている最もよく知られた分野の一つです。

✅ 毎日使っているソフトウェアで、NLPが組み込まれているものを思い浮かべられますか？例えば、ワードプロセッシングプログラムや普段使っているモバイルアプリなどはどうでしょう？

このレッスンで学ぶ内容:

- **言語の概念**。言語がどのように発展してきたか、そして主要な研究分野について。
- **定義と概念**。コンピュータがテキストを処理する方法についての定義や概念、例えば構文解析、文法、名詞や動詞の識別などを学びます。このレッスンではいくつかのコーディング課題があり、次のレッスンでコード化する重要な概念がいくつか紹介されます。

## 計算言語学

計算言語学は、数十年にわたる研究開発の分野で、コンピュータが言語を扱い、理解し、翻訳し、さらにはコミュニケーションを取る方法を研究します。自然言語処理（NLP）は、コンピュータが「自然な」、つまり人間の言語を処理する方法に焦点を当てた関連分野です。

### 例 - スマートフォンの音声入力

スマートフォンに音声入力をしたり、仮想アシスタントに質問をしたことがある場合、あなたの音声はテキスト形式に変換され、その後話した言語から処理、つまり*構文解析*されます。検出されたキーワードは、スマートフォンやアシスタントが理解し、行動できる形式に変換されます。

![理解](../../../../translated_images/comprehension.619708fc5959b0f6a24ebffba2ad7b0625391a476141df65b43b59de24e45c6f.ja.png)
> 言語の本当の理解は難しい！画像提供: [Jen Looper](https://twitter.com/jenlooper)

### この技術はどのように可能になったのか？

これは、誰かがこの機能を実現するコンピュータプログラムを書いたから可能になりました。数十年前、あるSF作家たちは、人々が主にコンピュータに話しかけ、コンピュータが常に正確にその意味を理解する未来を予測しました。しかし、実際にはそれほど簡単な問題ではなく、今日では問題の理解が進んでいるものの、文の意味を完全に理解する「完璧な」自然言語処理を達成するにはまだ多くの課題があります。特に、ユーモアや皮肉のような感情を文から検出することは非常に難しい問題です。

この時点で、学校の授業で文法の構成要素について学んだことを思い出すかもしれません。一部の国では、文法や言語学が専用の科目として教えられていますが、多くの国ではこれらのトピックは言語学習の一環として教えられます。例えば、初等教育で母国語を学ぶ際（読み書きを学ぶ）や、中等教育で第二言語を学ぶ際などです。名詞と動詞、または副詞と形容詞を区別するのが得意でなくても心配しないでください！

*単純現在形*と*現在進行形*の違いに苦労する場合、あなたは一人ではありません。これは多くの人々、特にその言語のネイティブスピーカーでさえも難しいことです。良いニュースは、コンピュータは形式的なルールを適用するのが非常に得意であり、人間と同じように文を*構文解析*するコードを書くことを学べるということです。後に学ぶより大きな課題は、文の*意味*や*感情*を理解することです。

## 前提条件

このレッスンの主な前提条件は、このレッスンの言語を読んで理解できることです。数学の問題や方程式を解く必要はありません。このレッスンの元の著者は英語で書きましたが、他の言語にも翻訳されているため、翻訳版を読んでいる可能性があります。いくつかの例では、異なる言語の文法ルールを比較するために複数の言語が使用されています。これらは翻訳されていませんが、説明文は翻訳されているため、意味は明確なはずです。

コーディング課題ではPythonを使用し、例はPython 3.8を使用しています。

このセクションで必要なもの:

- **Python 3の理解**。Python 3のプログラミング言語の理解。このレッスンでは入力、ループ、ファイル読み取り、配列を使用します。
- **Visual Studio Code + 拡張機能**。Visual Studio CodeとそのPython拡張機能を使用します。お好みのPython IDEを使用することもできます。
- **TextBlob**。 [TextBlob](https://github.com/sloria/TextBlob)はPython用の簡易テキスト処理ライブラリです。TextBlobのサイトで指示に従い、システムにインストールしてください（以下のようにコーパスもインストールしてください）:

   ```bash
   pip install -U textblob
   python -m textblob.download_corpora
   ```

> 💡 ヒント: PythonはVS Code環境で直接実行できます。詳細は[ドキュメント](https://code.visualstudio.com/docs/languages/python?WT.mc_id=academic-77952-leestott)を確認してください。

## 機械との対話

コンピュータが人間の言語を理解しようとする歴史は数十年前に遡り、自然言語処理を最初に考えた科学者の一人が*アラン・チューリング*です。

### 『チューリングテスト』

チューリングが1950年代に*人工知能*を研究していた際、人間とコンピュータが（タイピングによる通信を通じて）会話を行い、その会話の中で人間が相手が人間かコンピュータかを判断できない場合、コンピュータは*思考している*と言えるのではないかと考えました。

### インスピレーション - 『模倣ゲーム』

このアイデアは*模倣ゲーム*というパーティーゲームから着想を得たもので、尋問者が部屋に一人でいて、別の部屋にいる二人の人物のうち、どちらが男性でどちらが女性かを判断するというものです。尋問者はメモを送ることができ、書かれた回答からその人物の性別を明らかにする質問を考えなければなりません。当然、別の部屋にいるプレイヤーたちは、尋問者を誤解させたり混乱させたりするような回答をしながらも、誠実に答えているように見せかけようとします。

### Elizaの開発

1960年代、MITの科学者*ジョセフ・ワイゼンバウム*は[*Eliza*](https://wikipedia.org/wiki/ELIZA)というコンピュータの「セラピスト」を開発しました。このプログラムは人間に質問をし、回答を理解しているかのように見せかけました。しかし、Elizaは文を構文解析し、特定の文法構造やキーワードを識別して適切な回答をすることはできましたが、文を*理解*しているとは言えませんでした。例えば、Elizaが「**私は** <u>悲しい</u>」という形式の文を提示された場合、文の時制を変更し、いくつかの単語を追加して「**あなたは** <u>悲しい</u>のはどれくらいですか？」という回答を生成することがありました。

これにより、Elizaが文を理解し、続く質問をしているような印象を与えましたが、実際には時制を変更し、いくつかの単語を追加しているだけでした。Elizaが対応するキーワードを識別できない場合、代わりに多くの異なる文に適用可能なランダムな回答を生成しました。例えば、ユーザーが「**あなたは** <u>自転車</u>です」と書いた場合、Elizaは「**私は** <u>自転車</u>であるのはどれくらいですか？」と回答する可能性があり、より合理的な回答をすることはありませんでした。

[![Elizaとの会話](https://img.youtube.com/vi/RMK9AphfLco/0.jpg)](https://youtu.be/RMK9AphfLco "Elizaとの会話")

> 🎥 上の画像をクリックすると、オリジナルのELIZAプログラムについての動画が見られます

> 注: [Eliza](https://cacm.acm.org/magazines/1966/1/13317-elizaa-computer-program-for-the-study-of-natural-language-communication-between-man-and-machine/abstract)の1966年に発表されたオリジナルの説明をACMアカウントを持っている場合に読むことができます。または、[Wikipedia](https://wikipedia.org/wiki/ELIZA)でElizaについて読むことができます。

## 演習 - 基本的な会話型ボットのコーディング

会話型ボット、例えばElizaのようなものは、ユーザー入力を引き出し、理解しているかのように知的に応答するプログラムです。Elizaとは異なり、私たちのボットは知的な会話をしているように見せるための複数のルールを持っていません。代わりに、ほぼどんな些細な会話にも適用可能なランダムな応答を生成する能力だけを持っています。

### 計画

会話型ボットを構築する際のステップ:

1. ユーザーにボットとの対話方法を説明する指示を表示する
2. ループを開始する
   1. ユーザー入力を受け取る
   2. ユーザーが終了を要求した場合、終了する
   3. ユーザー入力を処理し、応答を決定する（この場合、応答は可能な汎用的な応答リストからランダムに選択される）
   4. 応答を表示する
3. ステップ2に戻る

### ボットの構築

次にボットを作成します。まずいくつかのフレーズを定義します。

1. 以下のランダムな応答を使用してPythonでこのボットを作成してください:

    ```python
    random_responses = ["That is quite interesting, please tell me more.",
                        "I see. Do go on.",
                        "Why do you say that?",
                        "Funny weather we've been having, isn't it?",
                        "Let's change the subject.",
                        "Did you catch the game last night?"]
    ```

    以下はサンプル出力の例です（ユーザー入力は`>`で始まる行です）:

    ```output
    Hello, I am Marvin, the simple robot.
    You can end this conversation at any time by typing 'bye'
    After typing each answer, press 'enter'
    How are you today?
    > I am good thanks
    That is quite interesting, please tell me more.
    > today I went for a walk     
    Did you catch the game last night?
    > I did, but my team lost
    Funny weather we've been having, isn't it?
    > yes but I hope next week is better
    Let's change the subject.
    > ok, lets talk about music
    Why do you say that?
    > because I like music!
    Why do you say that?
    > bye
    It was nice talking to you, goodbye!
    ```

    この課題の一つの解決策は[こちら](https://github.com/microsoft/ML-For-Beginners/blob/main/6-NLP/1-Introduction-to-NLP/solution/bot.py)です。

    ✅ 考えてみましょう

    1. ランダムな応答が、ボットが実際にユーザーを理解していると思わせることができると思いますか？
    2. ボットがより効果的になるためにはどのような機能が必要ですか？
    3. ボットが文の意味を本当に「理解」できる場合、会話中の以前の文の意味を「記憶」する必要があると思いますか？

---

## 🚀チャレンジ

上記の「考えてみましょう」の要素のいずれかを選び、それをコードで実装するか、擬似コードを使用して紙に解決策を書いてみてください。

次のレッスンでは、自然言語を解析するためのさまざまなアプローチや機械学習について学びます。

## [講義後のクイズ](https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/32/)

## 復習と自己学習

以下の参考文献を読んでさらに学びを深めてください。

### 参考文献

1. Schubert, Lenhart, "Computational Linguistics", *The Stanford Encyclopedia of Philosophy* (Spring 2020 Edition), Edward N. Zalta (ed.), URL = <https://plato.stanford.edu/archives/spr2020/entries/computational-linguistics/>.
2. Princeton University "About WordNet." [WordNet](https://wordnet.princeton.edu/). Princeton University. 2010. 

## 課題 

[ボットを探す](assignment.md)

---

**免責事項**:  
この文書は、AI翻訳サービス [Co-op Translator](https://github.com/Azure/co-op-translator) を使用して翻訳されています。正確性を期すよう努めておりますが、自動翻訳には誤りや不正確な表現が含まれる可能性があります。原文（元の言語で記載された文書）が公式な情報源と見なされるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用に起因する誤解や誤認について、当方は一切の責任を負いません。